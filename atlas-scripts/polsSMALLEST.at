<writeFiles.at

{This version should be loaded with atlas, and then executed by

atlas> >targetE8DIM.at TEST(G,DIM)

Resulting target file, when loaded into  atlas, produces a [[vec]]
GPairsSmallestDIM of size the number of DIM-dimensional
facets. Entry E = GPairsSmallestDIM[i] has E[0] equal to the facet as
a vec, and E[1:] the usual KPolData for the corresponding
K-character.}

{Progress of the job can be measured with "tail targetE8DIM"; a line
beginning

void: GPairsSmallestDIM[X]:=[[...

means that you have completed facet #X.}

set TEST(RealForm G, int dim) = void:
    begin
let rh=G.rho
then xo = G.x_open
then vd = FPP_vertex_data (G,-1)
then () = facet_verbose:=false
then varName = "GPairs"##to_string(dim)
then E8sizes = [ 610995,   25762046, 298908428, 1566837152,4413546720,
    7147951104, 6675056640,  3344302080, 696729600]
then size = if G = E8_s then E8sizes[dim] else
    W_fund_d_facets_card(G,dim) fi
    {Might CORRECT TO #FACETS; this is an overestimate.}
then FVind = null(dim+1), zero = null(G.rank)
then bary = ratvec: zero/1, wbF = ratvec: zero/1, gamma2 = ratvec:
    zero/1, wbeta0 = zero, bup = zero, bdown = zero
then pol = null_K_module(G)
then i = int:0
then () = write_real_form(G);
     prints("set ",varName," = [[vec]]: for i:",size," do [] od")
then facets = [FacetVerts]: facets_fundamental(G,dim)
in   for FV@k in facets
     do let bary_F=FacetBary: sum(G.rank,FV)/(dim+1)
       	then irdw = integrality_datum(G,bary_F)
	in for w in affine_orbit_ws(G,bary_F)
	   do let () = wbF := w*bary_F, iw = inverse(w)
	      then (x3,) = from_dominant(irdw, iw*G.two_rho)
	      in for tau in FPPtauRoots(G,wbF, -1)
	     	 do let () = wbeta0 := -tau + w*G.two_rho
		    then gamma2 = wbF + w*G.two_rho
		    then () = bup :=  wbeta0 +
		    	 ratvec_as_vec(w*(x3*(iw*gamma2)) - gamma2)
		    then () = FVind:= for v in (AffineCoWeylElt:(tau,w))*FV
		      	   	   do vd.lookup(v)
		      	   	   od.sort
		    then () = bary := w*bary_F + tau
		    then () = bdown := -inverse(x3)*(iw*bup)
		    then () = pol := K_type_pol( translate_param_by(
    character_formula(1*parameter(xo,rh+bup,bary+bup)),bdown))
    in prints("void: ",varName,"[",i,"]:=",[[int]]: [FVind]##K_data(pol));
    i+:=1
	         od
	     od
	 od
	 end

set TESTclassical(RealForm G, int dim) = void:
    begin
let rh=G.rho
then xo = G.x_open
then vd = FPP_vertex_data (G,-1)
then () = facet_verbose:=false
then varName = "GPairs"##to_string(dim)
then E8sizes = [ 610995,   25762046, 298908428, 1566837152,4413546720,
    7147951104, 6675056640,  3344302080, 696729600]
then size = if G = E8_s then E8sizes[dim] else
    W_fund_d_facets_card(G,dim) fi
    {Might CORRECT TO #FACETS; this is an overestimate.}
then FVind = null(dim+1), zero = null(G.rank)
then bary = ratvec: zero/1, wbF = ratvec: zero/1
then pol = null_K_module(G)
then i = int:0
then () = write_real_form(G);
     prints("set ",varName," = [[vec]]: for i:",size," do [] od")
then facets = [FacetVerts]: facets_fundamental(G,dim)
in   for FV@k in facets
     do let bary_F=FacetBary: sum(G.rank,FV)/(dim+1)
       	in for w in affine_orbit_ws(G,bary_F)
	   do let () = wbF := w*bary_F, iw = inverse(w)
	      in for tau in FPPtauRoots(G,wbF, -1)
	     	 do let () = FVind:= for v in (AffineCoWeylElt:(tau,w))*FV
		      	   	   do vd.lookup(v)
		      	   	   od.sort
		    then () = bary := w*bary_F + tau
		    then () = pol :=
    		    	 K_type_pol(character_formula(parameter(xo, rh,bary)))
    in prints("void: ",varName,"[",i,"]:=",[[int]]: [FVind]##K_data(pol));
    i+:=1
	         od
	     od
	 od
	 end
