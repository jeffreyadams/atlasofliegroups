<all

set all_reps_from_xy_blocks (RealForm G) = [Param]:
## for H in real_forms(dual_quasisplit_form(InnerClass:G))
   do let B=block(G,H) in for i:#B do parameter(element(B,i)) od
   od

set test_K_xy(RealForm G) = void:
   for p in all_reps_from_xy_blocks(G) do prints(p, " ", LKTs(p)) od

set test_K ([Param] B) = void:
(   let passed=true, G=real_form(B[0])
    then R_K=R_K_dom(KGB(G,0))
in prints("|R_K|=", #R_K)
;  for p@i in B
   do let lkts=LKTs(p)
      then hw=highest_weights(lkts[0])
      then ktypes=K_types(hw[0])
      , dim_hw=dimension(hw[0])
      , dim_ktype=dimension(lkts[0])
      , R_K_mu=R_K_dom_mu(hw[0])
      then test_1 = #hw*#ktypes = #R_K
      then test_2= dim_hw * #R_K = dim_ktype * #R_K_mu
      in passed := passed and test_1 and test_2
   ;  prints(new_line,"i=",i, new_line
            ,"number of LKTs: ", #lkts, new_line
            ,"#reps mu of K_#: ", #hw, new_line
            ,"#reps \tilde mu of K: ",   #ktypes)
   ;  prints("(# of mu)*(# of \tilde\mu)=|R_K|: ",test_1)
   ;  prints("dim(mu's): ", for mu in hw do dimension(mu) od)
   ;  prints("dim(\tilde\mu's): "
            ,for tildemu in ktypes do dimension(tildemu) od)
   ;  prints("dim(mu)*|R_K/R_K(mu)|=dim(\tilde\mu):", test_2) od
   ;  prints(new_line,"Tests passed: ", passed)
)

set G=SO(2,2)
set p=trivial(G)
set B=block_of(p)

{test_K(B)}
